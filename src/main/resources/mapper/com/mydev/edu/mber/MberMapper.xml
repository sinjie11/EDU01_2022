<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mydev.edu.mber.mapper.MberMapper">

	<!-- 회원 목록 -->
	<select id="selectMberList" parameterType="mberVO" resultType="mberVO">
		/* selectMberList */
		
		SELECT
			MBER_NO
			, MBER_ID
			, MBER_PW
			, NAME
			, SUBSTR(BIRTH,1,4) || '-' || SUBSTR(BIRTH,5,2) || '-' || SUBSTR(BIRTH,7,2) AS BIRTH
			, EMAIL
			, MOBILE_TEL_NO
			, USE_YN
			, REG_ID
			, TO_CHAR(REG_DATE, 'YYYY-MM-DD') AS REG_DATE
			, UPDT_ID
			, TO_CHAR(UPDT_DATE, 'YYYY-MM-DD') AS UPDT_DATE
			, ROW_NUMBER() OVER(ORDER BY MBER_NO DESC) AS RNUM
		FROM
			MEMBER
		WHERE
			USE_YN = 'Y'
	</select>
	
	<!-- 회원 검증 정보 -->
	<select id="selectMberConfirmInfo" parameterType="mberVO" resultType="mberVO">
		/* selectMberConfirmInfo */
		
		SELECT
			MBER_NO
			, MBER_ID
			, MBER_PW
			, NAME
			, SUBSTR(BIRTH,1,4) || '-' || SUBSTR(BIRTH,5,2) || '-' || SUBSTR(BIRTH,7,2) AS BIRTH
			, EMAIL
			, MOBILE_TEL_NO
			, USE_YN
			, REG_ID
			, TO_CHAR(REG_DATE, 'YYYY-MM-DD') AS REG_DATE
			, UPDT_ID
			, TO_CHAR(UPDT_DATE, 'YYYY-MM-DD') AS UPDT_DATE
		FROM
			MEMBER
		WHERE
			USE_YN = 'Y'
			<if test="mberId != null and mberId != ''">
				AND MBER_ID = #{mberId} 
			</if>
			<if test="mberPw != null and mberPw != ''">
				AND MBER_PW = #{mberPw} 
			</if>
	</select>
	
	<!-- 회원ID 중복 체크 -->
	<select id="selectMberIdDupCheck" parameterType="mberVO" resultType="int">
		/* selectMberIdDupCheck */
		
		SELECT
			COUNT(*)
		FROM
			MEMBER
		WHERE
			USE_YN = 'Y'
			AND MBER_ID = #{mberId} 
	</select>
	
	<!-- 회원 등록 -->
	<insert id="mberInsert" parameterType="mberVO">
		/* mberInsert */
		
		INSERT INTO
			MEMBER
				(
					MBER_NO
					, MBER_ID
					, MBER_PW
					, NAME
					, BIRTH
					, EMAIL
					, MOBILE_TEL_NO
					, USE_YN
					, REG_ID
					, REG_DATE
				)
			VALUES
				(
					MEMBER_SEQ.NEXTVAL
					, #{mberId}
					, #{mberPw}
					, #{name}
					, #{birth}
					, #{email}
					, #{mobileTelNo}
					, 'Y'
					, #{regId}
					, SYSDATE
				)
	</insert>
	
</mapper>